#!/usr/bin/env ruby
require 'htmlbeautifier'
require 'fileutils'

def beautify(input, output)
  HtmlBeautifier::Beautifier.new(output).scan(input)
  output << "\n"
end

if ARGV.any?
  ARGV.each do |path|
    input = File.read(path)
    temppath = path + ".tmp"
    File.open(temppath, "w") do |output|
      beautify input, output
    end
    FileUtils.mv temppath, path
  end
else
  beautify $stdin.read, $stdout
end
